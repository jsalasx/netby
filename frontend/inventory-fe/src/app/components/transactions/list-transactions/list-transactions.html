<div class="flex justify-center gap-5 py-5">
  <p-button label="Cargar" (click)="onLoadTransactions()" />
  <app-save-transaction (saved)="onTransactionSaved()"></app-save-transaction>
</div>
<div class="flex justify-center">
  <app-filter-transactions (filterToFetch)="onFilterTransactions($event)"></app-filter-transactions>
</div>

<app-get-transaction
  (onCloseDialog)="onCloseTransactionDialog()"
  [onClickView]="_onClickView()"
  [transaction]="selectedTransaction()"
></app-get-transaction>

<p-contextmenu #cm [model]="menuItems" />
<div class="p-5">
  <div class="mb-4">
    <p-button
      type="button"
      icon="pi pi-chevron-left"
      (click)="prev()"
      [disabled]="isFirstPage()"
      text
    />
    <p-button type="button" icon="pi pi-refresh" (click)="reset()" text />
    <p-button
      type="button"
      icon="pi pi-chevron-right"
      (click)="next()"
      [disabled]="isLastPage()"
      text
    />
  </div>
  <p-table
    [value]="transactions()"
    [paginator]="true"
    [totalRecords]="totalCount()"
    [first]="first()"
    [rows]="size()"
    [(contextMenuSelection)]="selectedTransaction"
    [contextMenu]="cm"
    dataKey="id"
    [lazy]="true"
    [tableStyle]="{ 'min-width': '50rem' }"
    selectionMode="single"
    [rowsPerPageOptions]="[10, 25, 50]"
    [lazy]="true"
    (onPage)="pageChange($event)"
  >
    <ng-template #header>
      <tr>
        <th>ID</th>
        <th>Type</th>
        <th>Total</th>
        <th>Comentario</th>
        <th>Fecha</th>
      </tr>
    </ng-template>
    <ng-template #body let-transaction>
      <tr
        class="cursor-pointer"
        (dblclick)="onGetTransaction(transaction)"
        [pSelectableRow]="transaction"
        [pContextMenuRow]="transaction"
      >
        <td>{{ transaction.id }}</td>
        <td>{{ transaction.type | typeTransactionType }}</td>
        <td>{{ transaction.totalAmount | priceFormatTotal }}</td>
        <td>{{ transaction.comment }}</td>
        <td>{{ transaction.createdAt | date : 'medium' : 'America/Guayaquil' }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
<p-toast></p-toast>
<p-confirmdialog />
